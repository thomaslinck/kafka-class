
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>Kafka Lab</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#welcome-to-kafka-lab" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Kafka Lab" class="md-header__button md-logo" aria-label="Kafka Lab" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kafka Lab
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Kafka Lab
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Kafka Lab" class="md-nav__button md-logo" aria-label="Kafka Lab" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Kafka Lab
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Kafka Lab
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Kafka Lab
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#login-to-pws" class="md-nav__link">
    <span class="md-ellipsis">
      Login to PWS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up" class="md-nav__link">
    <span class="md-ellipsis">
      Set up
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inspecting-the-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Inspecting the cluster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#listing-the-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Listing the topics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-your-own-topic" class="md-nav__link">
    <span class="md-ellipsis">
      Creating your own topic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inspecting-your-topic" class="md-nav__link">
    <span class="md-ellipsis">
      Inspecting your topic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#altering-the-number-of-partitions" class="md-nav__link">
    <span class="md-ellipsis">
      Altering the number of partitions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#altering-the-replication-factor" class="md-nav__link">
    <span class="md-ellipsis">
      Altering the replication factor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-and-reading-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Writing and reading topics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-and-reading-with-keys" class="md-nav__link">
    <span class="md-ellipsis">
      Writing and reading with keys
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-end" class="md-nav__link">
    <span class="md-ellipsis">
      THE END!
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#login-to-pws" class="md-nav__link">
    <span class="md-ellipsis">
      Login to PWS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up" class="md-nav__link">
    <span class="md-ellipsis">
      Set up
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inspecting-the-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Inspecting the cluster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#listing-the-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Listing the topics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-your-own-topic" class="md-nav__link">
    <span class="md-ellipsis">
      Creating your own topic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inspecting-your-topic" class="md-nav__link">
    <span class="md-ellipsis">
      Inspecting your topic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#altering-the-number-of-partitions" class="md-nav__link">
    <span class="md-ellipsis">
      Altering the number of partitions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#altering-the-replication-factor" class="md-nav__link">
    <span class="md-ellipsis">
      Altering the replication factor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-and-reading-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Writing and reading topics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-and-reading-with-keys" class="md-nav__link">
    <span class="md-ellipsis">
      Writing and reading with keys
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-end" class="md-nav__link">
    <span class="md-ellipsis">
      THE END!
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="welcome-to-kafka-lab">Welcome to Kafka Lab!</h1>
<p>The goal of this material is to get you started with Apache Kafka. You will be watching a series of short videos from Confluent, a company founded by the same people who created Kafka. Along with the videos, you will get the chance of experimenting with the concepts using PWS (our very own distributed server for Kafka). Running the commands should be very quick. Invest some time in understanding what is going on and why outputs are in a certain way. We will dive deeper into each of these topics in class. </p>
<h2 id="login-to-pws">Login to PWS</h2>
<p>All the steps below need to be executed from within PWS. So to get started, open your terminal and ssh into the machine. </p>
<div class="admonition tip">
<p class="admonition-title">Information for accessing PWS can be found in the <a href="https://docs.google.com/document/d/1NNElqfBCUZsK_BgwQZvnPne-38ntbniQEq3OPMKLPgs/edit#heading=h.tavkzf56hnn">syllabus</a></p>
</div>
<h2 id="set-up">Set up</h2>
<p>Let's start by exporting some env vars. You need to do this every time you ssh into the machine (or add them to your <code>.bashrc</code> in c0, up to you). </p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>export KAFKA_PATH=&#39;/opt/kafka/bin&#39; 
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>export BOOTSTRAP_SERVER=&#39;cs0.minerva.local:9092&#39; 
</span></code></pre></div>
<h2 id="inspecting-the-cluster">Inspecting the cluster</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/qu96DFXtbG4?si=cxH_fHKbDlMSiUCx" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<p>To start, run: 
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>${KAFKA_PATH}/kafka-metadata-quorum.sh --bootstrap-server $BOOTSTRAP_SERVER describe --status 
</span></code></pre></div></p>
<p>This is the first step to make sure that the system is working correctly. Your output should look something like: 
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>ClusterId:              dZmpfrGnSaq_XBDWsSsKPg
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>LeaderId:               0
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>LeaderEpoch:            25951
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>HighWatermark:          140536
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>MaxFollowerLag:         0
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>MaxFollowerLagTimeMs:   0
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>CurrentVoters:          [0,1,2]
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>CurrentObservers:       [3,4,5]
</span></code></pre></div></p>
<p>CurrentObservers are the actual Kafka brokers that we are interested in. These form our Kafka Cluster. Notice that we have 3 brokers with IDs 3,4,5 (check your own output from terminal). CurrentVoters are the Kafka controllers, responsible for managing consensus. We will not focus on these. </p>
<h2 id="listing-the-topics">Listing the topics</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/kj9JH3ZdsBQ?si=_aLSAtxvfeOw7IvY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<p>The command below allows you to see all the topics in our cluster. Remember that a Kafka topic is an abstraction that groups related events together. Consumers can subscribe to topics they are interested to. </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This command will list a few different topics. There should not be any topic with your name yet. We will create it soon. </p>
</div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>${KAFKA_PATH}/kafka-topics.sh --list --bootstrap-server $BOOTSTRAP_SERVER
</span></code></pre></div>
<h2 id="creating-your-own-topic">Creating your own topic</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/y9BStKvVzSs?si=7UVi35DdLuVuYu3r" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<p>First read the command below. Running this command will create a new topic called <code>&lt;your_username&gt;_topic</code>. Notice that the topic will have both the number of partitions and the replication factor set as 1. </p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>${KAFKA_PATH}/kafka-topics.sh --create --bootstrap-server $BOOTSTRAP_SERVER --replication-factor 1 --partitions 1 --topic ${USER}_topic
</span></code></pre></div>
<p>Feel free to ignore the warning message. You can ensure that creation was succesful by running all the topics again and finding your own:
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>${KAFKA_PATH}/kafka-topics.sh --list --bootstrap-server $BOOTSTRAP_SERVER
</span></code></pre></div></p>
<h2 id="inspecting-your-topic">Inspecting your topic</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/jHnyBSUVcOU?si=V60dBJZD8-vIQeAE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<p>The following command will let you inspect your topic: </p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>${KAFKA_PATH}/kafka-topics.sh --describe --bootstrap-server $BOOTSTRAP_SERVER --topic ${USER}_topic
</span></code></pre></div>
<p>Answer the following questions: <br />
1. Where is each partition stored? 
1. Is this model fault tolerant? 
1. Is this model scalable? </p>
<h2 id="altering-the-number-of-partitions">Altering the number of partitions</h2>
<p>Now we will change the number of partitions in the topic. Run: </p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>${KAFKA_PATH}/kafka-topics.sh --alter --bootstrap-server $BOOTSTRAP_SERVER --topic ${USER}_topic --partitions 3
</span></code></pre></div>
If everything is succesful nothing will be printed. Inspect your topic again: </p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>${KAFKA_PATH}/kafka-topics.sh --describe --bootstrap-server $BOOTSTRAP_SERVER --topic ${USER}_topic
</span></code></pre></div>
<p>Things changed! You should now see 3 partitions. Given that we have exactly 3 brokers, Kafka will assign each partition to a different broker to balance load. </p>
<p>Think again about the questions from before, particularly: 
1. Is this model fault tolerant? 
1. Is this model scalable? </p>
<h2 id="altering-the-replication-factor">Altering the replication factor</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Vo6Mv5YPOJU?si=ozzMs5CVFDoOXUvv" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<p>There isn't a way to simply alter the replication factor as we did with the partitions. What we will do instead is to delete your topic, recreate it with the new configuration and finally inspect it: </p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>${KAFKA_PATH}/kafka-topics.sh --bootstrap-server $BOOTSTRAP_SERVER --delete --topic ${USER}_topic
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>${KAFKA_PATH}/kafka-topics.sh --create --bootstrap-server $BOOTSTRAP_SERVER --replication-factor 2 --partitions 3 --topic ${USER}_topic
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>${KAFKA_PATH}/kafka-topics.sh --describe --bootstrap-server $BOOTSTRAP_SERVER --topic ${USER}_topic
</span></code></pre></div>
<p>Now you should see each partition being replicated in two brokers: the leader and an additional replica. Once again, Kafka will take care of distributing the partitions evenly across brokers. </p>
<p>Think about the questions from before, particularly: 
1. Is this model fault tolerant? 
1. Is this model scalable? </p>
<h2 id="writing-and-reading-topics">Writing and reading topics</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/I7zm3on_cQQ?si=qy-HpT4ZGX2Q2N3M" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<iframe width="560" height="315" src="https://www.youtube.com/embed/Z9g4jMQwog0?si=QU2Xg6lqBFdmoi1m" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<p>First of all, duplicate your terminal window. SSH into PWS in the additional window. One tab will be the producer and the other will be the consumer. </p>
<p>Create the consumer in one tab by running: 
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>${KAFKA_PATH}/kafka-console-consumer.sh --bootstrap-server $BOOTSTRAP_SERVER --topic ${USER}_topic --from-beginning  --property print.partition=true
</span></code></pre></div></p>
<p>You should keep this tab open and running. </p>
<p>Then, turn your other tab into a producer by running the command below. You can type messages and press enter to publish them. </p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>${KAFKA_PATH}/kafka-console-producer.sh --broker-list $BOOTSTRAP_SERVER --topic ${USER}_topic --producer-property partitioner.class=org.apache.kafka.clients.producer.RoundRobinPartitioner 
</span></code></pre></div>
<p>As you publish new messages, you will see them showing up in the consumer! This indicates that your topics is working well within the Kafka cluster. </p>
<h2 id="writing-and-reading-with-keys">Writing and reading with keys</h2>
<p>You can now press <code>ctrl+d</code> on your producer. This will close it. Reboot your producer using the following command to enable key:value messages: </p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>${KAFKA_PATH}/kafka-console-producer.sh --broker-list $BOOTSTRAP_SERVER --topic ${USER}_topic --property &quot;parse.key=true&quot; --property &quot;key.separator=:&quot; 
</span></code></pre></div>
<p>Now you can send messages in the format <code>key:value</code>. For example, you can send <code>name:thomas</code>, where name is the key and thomas is the value. Observe how messages with the same key are sent to the same partition. Play around with a few messages. </p>
<h2 id="the-end">THE END!</h2>
<p>And that's it for today's PCW! You can press <code>ctrl+d</code> on the producer and <code>ctrl+c</code> on the consumer to close both. Then exit PWS and you will be done! </p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.instant", "navigation.footer", "content.tooltips", "content.code.copy"], "search": "assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>